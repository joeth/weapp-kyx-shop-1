"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_lodash=require("./../../npm/lodash/lodash.js"),_lodash2=_interopRequireDefault(_lodash),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),devWidth=750,winRatio=_wepy2.default.getSystemInfoSync().windowWidth/devWidth,ProductFilter=function(e){function t(){var e,n,i,o;_classCallCheck(this,t);for(var r=arguments.length,a=Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=i=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),i.props={datalist:{type:Array,default:[],coerce:function(e){return e.map(function(e){return e.child=e.child.map(function(e){return e.checked=!1,e}),e})}},checked:{type:Array,default:[],twoWay:!0}},i.data={selected:null},i.events={showFilter:function(){var e=this.$wxpage.selectComponent(".J_Filter");e&&e.show(),this.onReinit()},hideFilter:function(){var e=this.$wxpage.selectComponent(".J_Filter");e&&e.hide()}},i.methods={tap:function(e){},onRadioChange:function(e){var t=e.detail.value,n=e.currentTarget.dataset.key,i=_lodash2.default.cloneDeep(this.selected)||[],o=_lodash2.default.cloneDeep(this.datalist)||[];this.datalist=o.map(function(e){return e.key==n&&e.child.map(function(e){return e.checked=!(e.key!=t),e}),e}),i.some(function(e){return e.key==n})?i=i.map(function(e){return e.key==n&&(e.val=[t]),e}):i.push({key:n,val:[t]}),this.selected=i},onCheckboxChange:function(e){var t=e.detail.value,n=e.currentTarget.dataset.key,i=_lodash2.default.cloneDeep(this.selected)||[],o=_lodash2.default.cloneDeep(this.datalist)||[];this.datalist=o.map(function(e){return e.key==n&&(e.child=e.child.map(function(e){return e.checked=!!t.some(function(t){return t==e.key}),e})),e}),i.some(function(e){return e.key==n})?i=i.map(function(e){return e.key==n&&(e.val=t),e}):i.push({key:n,val:t}),this.selected=i},onCancel:function(){this.$emit("on-cancel"),this.$emit("hideFilter")},onSubmit:function(){this.$emit("hideFilter"),_lodash2.default.isEqual(this.selected,this.checked)||(this.checked=_lodash2.default.cloneDeep(this.selected),this.$emit("on-submit",this.checked))},onReset:function(e){this.selected=null,this.datalist=this.datalist.map(function(e){return e.child=e.child.map(function(e){return e.checked=!1,e}),e}),this.$emit("on-reset")}},o=n,_possibleConstructorReturn(i,o)}return _inherits(t,e),_createClass(t,[{key:"onReinit",value:function(){var e=this;setTimeout(function(){var t=[];e.selected=_lodash2.default.cloneDeep(e.checked),e.checked&&e.checked.forEach(function(e){t=t.concat(e.val)}),e.datalist=e.datalist.map(function(e){return e.child=e.child.map(function(e){return e.checked=!!t.some(function(t){return t==e.key}),e}),e}),e.$apply()},1)}},{key:"onLoad",value:function(){this.onReinit()}}]),t}(_wepy2.default.component);exports.default=ProductFilter;